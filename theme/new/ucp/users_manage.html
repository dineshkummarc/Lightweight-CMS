<h2>{%$MODULE_TITLE%}</h2>
<script type="text/javascript" src="./acp/pickacc.js"></script> 

<script type="text/javascript">
    function setempty()
    {
        document.getElementById("passinput").value = "";
    }	
</script>
<div id="userinfo">
<form method="post" action="./ucp.php?id={%$_GET['id']%}&a={%$_GET['a']%}&mode=updateuser" id="usereditor" name="update">
  <table class="padded_table" style="text-align: left;" border="0" cellpadding="0" cellspacing="0">
    <tbody>
      <tr>
        <td>{%$language['ui']['user']%} <span style="color: rgb(255, 0, 0);"></span></td>
        <td><input style="vertical-align: top; "  id="username" oninput="updatepreview()" name="username" type="text" value="{%$TEMPLATE_VARS['SELECTEDUSER']['username']%}"><br>
        </td>
      </tr>
      <tr>
        <td>{%$language['ui']['password']%} </td>
        <td><input style="vertical-align: top; " id="passinput" name="password"  type="password"></td>
      </tr>
      <tr>
        <td>{%$language['ui']['password_confirm']%}</td>
        <td><input style="vertical-align: top; " name="password_confirm"  type="password"></td>
      </tr>
      <tr>
        <td>{%$language['ui']['email']%} </td>
        <td><input style="vertical-align: top;" name="email" value="{%$TEMPLATE_VARS['SELECTEDUSER']['user_email']%}"  type="text"></td>
      </tr>
      <tr>
        <td>{%$language['ui']['facebook']%}</td>
        <td><input style="vertical-align: top; " name="facebook" value="{%$TEMPLATE_VARS['SELECTEDUSER']['user_facebook']%}"  type="text"></td>
      </tr>
      <tr>
        <td>{%$language['ui']['avatar']%}</td>
        <td><input style="vertical-align: top; " oninput="updatepreview()" name="avatar" value="{%$TEMPLATE_VARS['SELECTEDUSER']['user_avatar']%}"  type="text">
      </tr>
      <tr>
        <td>{%$language['ui']['show_email']%}</td>
        <td><input style="vertical-align: top; "  name="show_email" {%$TEMPLATE_VARS['SELECTEDUSER']['user_show_mail']%} type="checkbox"></td>
      </tr>
      <tr>
        <td>{%$language['ui']['show_facebook']%}</td>
        <td><input style="vertical-align: top; "  name="show_facebook" {%$TEMPLATE_VARS['SELECTEDUSER']['user_show_facebook']%} type="checkbox"></td>
      </tr>
      <tr>
        <td>{%$language['ui']['cover_image']%}</td>
        <td><input style="vertical-align: top; " oninput="updatepreview()" name="cover" value="{%$TEMPLATE_VARS['SELECTEDUSER']['cover']%}" type="text"></td>
      </tr>
      <tr>
        <td>{%$language['ui']['cover_offset']%}</td>
        <td><input style="vertical-align: top; "  oninput="updatepreview()" name="cover_h_offset" value="{%$TEMPLATE_VARS['SELECTEDUSER']['cover_h_offset']%}" type="number"></td>
      </tr>
      <tr>
        <td>{%$language['ui']['about']%}<br>
        </td>
        <td><textarea cols="100" rows="5" name="about">{%$TEMPLATE_VARS['SELECTEDUSER']['about']%}</textarea><br>
        </td>
      </tr>
     <tr>
        <td>{%$language['ui']['signature']%}<br>
        </td>
        <td><textarea cols="100" rows="5" name="signature">{%$TEMPLATE_VARS['SELECTEDUSER']['user_signature']%}</textarea><br>
        </td>
      </tr>

    </tbody>
  </table>
  <br>
  <input class="button" value="{%$language['ui']['update']%}" type="submit"> {%$language['ui']['or']%}
  <a href="?id{%$_GET['id']%}" color="red"><b><span style="color: rgb(200, 0, 10);">{%$language['ui']['cancel']%}</span></b></a><br>
</form>

{%$language['ui']['cover_preview']%}cover preview:<br>
<div id="cover" style="height: 286px; background-size: 100%;">
    <table style="height: 100%;">
        <tr>
            <td style="vertical-align: bottom;"><div class="profile_image"><img id="avatar" src=""></div></td>
            <td  style="vertical-align: bottom;"><h1 class="username"></h1></td>
        </tr>
    </table>
    </div>
</div>

<script type="text/javascript">
    setempty();
</script>

<script>
    var default_img = '../theme/{%$site_settings['template']%}/icons/default_profile.png';;
    function updatepreview(){
        var avatar = $("input[name=avatar]").val();
        if(avatar == ""){
            avatar = default_img;
        }
        $("#avatar").attr("src",avatar);
        $("#cover").css('background-image',"url('"+$("input[name=cover]").val()+"')");
        $("#cover").css('background-position','0px '+$("input[name=cover_h_offset]").val()+'px');
        $(".username").html($("input[name=username]").val());
    }
    
    updatepreview();
    
    var allowAvatar = "{%$TEMPLATE_VARS['ALLOW_AVATAR']%}";
    var allowsignature = "{%$TEMPLATE_VARS['ALLOW_SIG']%}";
    var allowEdit = "{%$TEMPLATE_VARS['ALLOW_EDIT']%}";
    
    if(allowAvatar != "1"){
        $("input[name=avatar]").val("");
        $("input[name=avatar]").prop( "disabled", true );
    }
    if(allowsignature != "1"){
        $("textarea[name=signature]").val("");
        $("textarea[name=signature]").prop( "disabled", true );
    }
    if(allowEdit != "1"){
      $("textarea").prop( "disabled", true );  
      $("input").prop( "disabled", true );  
    }
    
    
</script>
